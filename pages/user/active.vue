<template>
	<view class="active-box">
		<view class="active-img-box">
			<img class="active-img" style="height:4061.5942upx;" src="https://cdn.doudouxiongglobal.com/pinxiang/image/vip/aboutvip.png"/>
			<view>
				<view class="active-content-box">
					<view class="active-title">★关于信任</view>
					<view class="active-content">
						<p>品象养车股东背景拥有经纬中国、真格基金、微软中国、阿里前合伙人等知名投资机构相关背景，同时品象养车与人保车险、太平洋车险等知名车险品牌战略合作。</p>
						<p class="br">　</p>
						<p>经纬中国：经纬创投因其杰出的投资业绩和悠久的历史在全球风险投资行业中享有盛誉，而经纬中国正是前者在中国设立的联合公司，正式成立于2008年，并专注于寻找中国大陆的投资机会。</p>
						<p>自1977年创立迄今，经纬创投已完成数百项投资并在许多成功企业的发展过程中起到重要作用。在经纬创投的投资组合中有65家公司已经上市，另有110家最终通过兼并收购方式赢得投资回报。就投资回报率而言，经纬创投始终在全球风险投资公司中名列前茅。</p>
						<p>经纬中国结合本土知识和国际视野而创立。我们的团队由成功创业者和经验丰富的投资者共同组成。过往的成功业绩包括滴滴出行、饿了么、瓜子二手车、富途证券、乐信集团、陌陌、猎豹移动、猎聘、VIPKID、理想汽车、新氧、震坤行、容百锂电、星际荣耀、太美医疗等。我们的投资分布在不同领域不同阶段。</p>
						<p class="br">　</p>
						<p>真格基金：真格基金是由徐小平、王强先生于 2011 年联合红杉资本中国基金创立的早期投资机构。真格基金自创立伊始，一直积极在互联网、移动互联网、未来科技、人工智能、企业服务、医疗健康、消费升级、教育、内容娱乐及大文化等不同领域寻找最优秀的创业团队和引领时代的投资机会。</p>
						<p>真格基金陆续投资了 700 余家创业公司，并收获了美菜、英雄互娱、VIPKID、一起教育科技、找钢网、罗辑思维、依图科技、小红书、蜜芽、 完美日记等行业瞩目的独角兽企业。自 2011 年起，真格基金被投公司世纪佳缘(NASDAQ: DATE)、聚美优品(NYSE: JMEI)、兰亭集势(NYSE: LITB)、51Talk(NYSE: COE)、牛电科技(NASDAQ: NIU)等中国概念股陆续在美上市，奠定了年轻的真格基金在中国早期投资领域的领先地位。自 2014 年清科“中国股权投资年度排名”设立早期投资机构排名以来，真格基金已连续 5 年获得“中国早期投资机构 30 强”第 1 名；真格基金创始人徐小平从 2016 年起连续四年入选福布斯“全球最佳创投人榜单( Midas List )”。</p>
						<p class="br">　</p>
						<p>微软中国：微软中国投资控股有限公司主要负责在华投资、合资、合作业务，旨于与中国的信息产业伙伴们联手走向全球市场。</p>
						<p class="br">　</p>
						<p>人保车险：中国人民财产保险股份有限公司（PICC P&C，以下简称“中国人保财险”）的前身是1949年10月20日成立的中国人民保险公司，是中国人民保险集团股份有限公司（PICC Group，2018年《财富》“世界500 强”第117位）的核心成员和标志性主业，是国内历史悠久、业务规模大、综合实力强的大型国有财产保险公司，保费规模居全球财险市场前列。公司于2003年11月6日在香港联交所主板上市（股票代码2328）。人保车辆保险简称人保车险，是属于中国人民财产保险股份有限公司的业务范围，万元以下一小时通知赔付，异地出险、就地理赔，故障车辆免费救援，事故车托管全国7X24小时全天候查勘和理赔咨询服务等人保车险专属服务。</p>
						<p class="br">　</p>
						<p>太平洋车险：中国太平洋财产保险股份有限公司的神行车保机动车辆保险是国内优质的品牌车辆保险。神行车保机动车保险产品在传统产品的基础上，提供更低的价格、更好的服务。行业车险产品包括机动车损失险、三者险、车上人员责任险、盗抢险、车损免赔额特约险、玻璃单独破碎险、车身油漆单独损伤险和基本险不计免赔特约险等险种。</p>
					</view>
				</view>
				<view class="active-content-box">
					<view class="active-title">★关于价格</view>
					<view class="active-content">
						<p>Q：汽修养护门店的价格为什么贵？价格还不统一？</p>
						<p>A：随着汽车保有量的日益扩张，汽车后市场长期的恶性竞争导致门店获客成本逐年增加；门店密度大，门店客户到店率低。</p>
						<p class="br">　</p>
						<p>Q：品象养车为什么可以这么便宜？</p>
						<p>A：品象养车与门店签订长期合作协议，门店商户借助「品象养车」平台0成本获客，门店只需提供标准的服务与正品产品；品象养车甄选每公里1家精品门店，用户减少选择成本，门店更加精准的获得有效客户。</p>
					</view>
				</view>
				<view class="active-content-box">
					<view class="active-title">★关于品质</view>
					<view class="active-content">
						<p>☉平均面积超250㎡门店<p>
						<p>☉平均至少6个工位</p>
						<p>☉平均超8名专业汽修工全程为您服务</p>
						<p class="br">　</p>
						<p>品象团队</p>
						<p>走访杭州九大城区376条道路</p>
						<p>调研<text>843家</text>汽修养护门店</p>
						<p class="br">　</p>
						<p>“选址 规模 服务 专业 效率 品质”</p>
						<p>从<text>选址、规模、服务、专业、效率、品质</text>六大维度，及延展出的门店整洁度，</p>
					</view>
				</view>
				<view class="active-content-box">
					<view class="active-title">★你可能会问到的问题</view>
					<view class="active-content">
						<p>Q: 会不会有隐性消费？</p>
						<p>A: 品象会员通过品象小程序预约洗车或者保养后，在约定的时间内到达门店完成项目。期间没有任何需要额外支付的费用。当然，如果您在保养时需要更换与权益不同型号的机油，只要按照市场价补齐机油价格即可按照正常程序进行保养。</p>
						<p>Q: 会不会预约不到工位？</p>
						<p>A: 品象每月持续更新上线门店，您可关注【<text>品象养车</text>】公众号，关注上新信息。</p>
						<p>当然，门店节假日工位一定是最为抢手的，还请您提前预约，安排好时间。</p>
						<p class="br">　</p>
						<p>Q: 品象会员权益可以和朋友一起使用吗？</p>
						<p>A: 在注册成为品象会员时，会员权益就与您的车牌信息绑定了，所以只能一卡一车使用，但是后续我们会推出赠卡服务，您可以为自己的好友购买一张品象畅养卡</p>
						<p class="br">　</p>
						<p>Q: 这张卡适合谁用？</p>
						<p>A: 过保的所有非营运车主均可使用，针对“营运车辆”品象养车正在筹备上线中。</p>
						<p class="br">　</p>
						<p>Q: 该怎么用这张卡？</p>
						<p>A: 购买权益成为品象会员——完善个人车辆信息——进入品象小程序选择门店——选择项目预定工位——车辆如期到店—离店后可再次预约。若您因个人或其他原因可以在预约时间前3小时内申请取消预约。</p>
						<p class="br">　</p>
						<p>Tips:频繁取消预约将会限制您短期内预约功能，请谨慎操作。</p>
					</view>
				</view>
				
			</view>
		</view>
		<view class="active-join">
			<view class="active-join-top">
				<view class="active-join-price" :class="{'selected':vipSelected==0}" @click="selectVipCard(0)">
					<view class="active-join-price-left">
						全合成机油版
					</view>
					<view class="active-join-price-right">
						<view>599</view>元/年
					</view>
				</view>
				<view class="active-join-price2" :class="{'selected':vipSelected==1}" @click="selectVipCard(1)">
					<view class="active-join-price-left">
						半合成机油版
					</view>
					<view class="active-join-price-right">
						<view>399</view>元/年
					</view>
				</view>
			</view>
			<view class="active-join-tip">
				<view class="tip-left">
					
				</view>
				<view class="tip-right">
					营运车辆暂时未开通服务，请勿购买！
				</view>
			</view>
			<view class="active-join-agree">
				<view class="agree-box" @click="agreementRadio">
					<radio class="agree-check" :checked="agreementChecked" color="#FE5100"></radio>
					<text>开通会员需同意</text>
					<text class="agree-color" @click="agreement">《会员协议》</text>
				</view>
			</view>
			<button v-if="phone==''" class="active-join-button" open-type="getPhoneNumber" @getphonenumber="getPhoneNumber">
				加入会员，免费保养
			</button>
			<button v-if="phone!=''" class="active-join-button" @click="buyVIP">
				加入会员，免费保养
			</button>
		</view>
	</view>
</template>

<script>
	import {decryptPhone,changePhone,payDetail,payVip} from '../../api/index.js'
	export default {
		data() {
			return {
				bgc:"https://cdn.doudouxiongglobal.com/Default_image/78c34fe76e6c748a1b7f7b6a650a5e8.png",
				phone : '',
				redirect:'',
				vipSelected:0,
				agreementChecked:false,
				vip:0
			}
		},
		methods: {
			getPhoneNumber(e){
				let that = this
				let userData = uni.getStorageSync('user_data')
				if(userData === null || userData.length === 0){
					wx.showModal({
						title:"提示",
						content:"未登录，请前往登录",
						success: function (res) {
						            if (res.cancel) {
						               //点击取消,默认隐藏弹框
						            } else {
						              uni.switchTab({
						              	url:"/pages/user/user"
						              })
						            }
						         },
					})
					return false;
				}
				if(e.detail.errMsg === 'getPhoneNumber:ok'){
					let wxOpenID = uni.getStorageSync('wxOpenID')
					decryptPhone({'OpenID':wxOpenID,'Encrypt':e.detail.encryptedData,'IV':e.detail.iv}).then(res => {
						if(res.Code === 200){
							that.phone = res.Data.Phone
							changePhone({Phone:res.Data.Phone}).then(response =>{
								if(response.Code === 200){
									let userData = uni.getStorageSync('user_data')
									userData = JSON.parse(userData)
									userData['Phone'] = res.Data.Phone
									uni.setStorageSync('user_data',JSON.stringify(userData))
									that.buyVIP()
								}
							})
						}
					})
				}
			},
			async buyVIP(){
				let that = this
				if(this.agreementChecked==false){
					wx.showToast({
						title:"请先阅读会员协议"
					})
					return false
				}
				
				let detail =  await payDetail({
					OpenID: uni.getStorageSync('wxOpenID'),
					VipType : this.vipSelected
				})
				if(detail.Code === 200){
					uni.requestPayment({
					    provider: 'wxpay',
					    timeStamp: detail.Data.timestamp.toString(),
					    nonceStr: detail.Data.nonce_str,
					    package: `prepay_id=${detail.Data.prepay_id}`,
					    signType: 'MD5',
					    paySign: detail.Data.sign,
					    success: function (res) {
					        console.log('success:' + JSON.stringify(res));
							if(res.errMsg=='requestPayment:ok'){
								payVip({OrderNo:detail.Data.order_number,VipType:that.vipSelected}).then(response=>{
									if(response.Code === 200){
										let userData = uni.getStorageSync('user_data')
										userData = JSON.parse(userData)
										userData.Vip = 1
										uni.setStorageSync('user_data',JSON.stringify(userData))
										wx.showToast({
											title:"购买成功",
											success() {
												wx.redirectTo({
													url:'/pages/user/vip/vip'
												})
											}
										})
	
									}
								})
							}else{
								wx.showToast({
									title:"支付失败",
									icon:"none"
								})
							}
					    },
					    fail: function (err) {
					        console.log('fail:' + JSON.stringify(err));
					    }
					});
				}
				
			},
			// 跳转到会员协议
			agreement(){
				uni.navigateTo({
					url:"/pages/user/vipAgreement"
				})
			},
			selectVipCard(type){
				this.vipSelected = type
			},
			// 点击同意条款
			agreementRadio(){
				this.agreementChecked = true
			}
		
		},
		onLoad(options) {
			let userData = uni.getStorageSync('user_data')
			if(userData === null || userData.length === 0){
				return false;
			}
			userData = JSON.parse(userData)
			if(userData['Phone'] !== ''){
				this.phone = userData['Phone']
			}
			// this.redirect = options.redirect
		}
	}
</script>

<style lang="scss" scoped>
.active-box{
	width:750upx;
	.active-img-box{
		width:750upx;
		padding-bottom:319upx;
		.active-img{
			width:750upx;
		}
	}
	.active-join{
		position: fixed;
		bottom:0;
		left:0;
		z-index:2;
		width:750upx;
		height:319upx;
		background: #fff;
		.active-join-top{
			display: flex;
			justify-content:flex-start;
			margin-top:16upx;
			.active-join-price{
				width:324upx;
				height:76upx;
				line-height: 76upx;
				margin-left:40upx;
				background:rgba(254,81,0,0.15);
				border-radius:7upx;
				display: flex;
				justify-content: flex-start;
				font-size:25upx;
				.active-join-price-left{
					margin-left: 14upx;
				}
				.active-join-price-right{
					margin-left: 20upx;
					display: flex;
					font-size:29upx;
					justify-content: space-between;
					view{
						color:#FE5100;
					}
				}
			}
			.active-join-price2{
				width:324upx;
				height:76upx;
				line-height: 76upx;
				margin-left:40upx;
				background:rgba(254,81,0,0.15);
				border-radius:7upx;
				display: flex;
				justify-content: flex-start;
				font-size:25upx;
				.active-join-price-left{
					margin-left: 14upx;
				}
				.active-join-price-right{
					margin-left: 20upx;
					display: flex;
					font-size:29upx;
					justify-content: space-between;
					view{
						color:#FE5100;
					}
				}
			}
			
		}
		.active-join-tip{
			display: flex;
			justify-content: flex-start;
			width:668upx;
			margin:20upx auto 10upx auto;
			.tip-left{
				width:18upx;
				height:18upx;
				border-radius: 18upx;
				background: #FE5100;
				margin-top: 7upx;
			}
			.tip-right{
				height:31upx;
				font-size:22upx;
				color:#FE5100;
				line-height:31upx;
				margin-left: 7upx;
			}
		}
		.active-join-agree{
			font-size:22upx;
			.agree-box{
				height:55upx;
				line-height:55upx;
				text-align: center;
			}
			.agree-check{
				transform:scale(0.5);
			}
			.agree-color{
				color:#FE5100;
			}
		}
		.active-join-button{
			width:750upx;
			height:89upx;
			margin:24upx auto;
			background:#FE5100;
			border-radius:0upx;
			font-size:29upx;
			color:#fff;
			line-height:89upx;
			letter-spacing:5upx;
			text-align: center;
		}
	}
	.selected{
		background:rgba(254,81,0,0.5) !important;
	}
	.active-content-box{
		width: 90%;
		margin:0 auto;
		color:rgb(81, 81, 81);
		margin-top:50upx;
		margin-bottom: 60upx;
		.active-title{
			font-size: 30upx;
			color: rgb(254, 81, 0);
			margin-bottom:10upx;
		}
		.active-content{
			font-size: 28upx;
			line-height: 40upx;
			white-space: 10upx;
			color:rgb(81, 81, 81);
			.br{
				margin-top:30upx;
			}
			p{
				margin-bottom:10upx;
				color:rgb(81, 81, 81);
				text{
					color: rgb(254, 81, 0);
				}
			}
		}
	}
}
</style>